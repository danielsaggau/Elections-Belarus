---
title: "code_elections"
author: ""
date: "3/7/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Installing the packages 


```{r}
library(readxl)
library(MASS)
library(glmnet)
library(tidyverse)
library(broom)
library(glmnet)
```

```{r}
data <- read.csv("~/Elections-Belarus/train_pls1")

n = nrow(data)
p = ncol(data) -1

data = data %>% 
  filter_all(all_vars(!is.infinite(.)))

model_lasso = glmnet(x = as.matrix(data[, - (p+1)]), y = data$lukashenko_share, alpha =1)
plot(model_lasso)
```


```{r}
lambda_lasso = cv.glmnet(x = as.matrix(data[,-(p+1)]),
                         y = data$lukashenko_share, alpha =1)$lambda.min

coef_lasso <- model_lasso$beta[, which(model_lasso$lambda == lambda_lasso)]
coef_lasso

# LASSO-Regularisierung:
library(plotmo)
par(mfrow = c(1, 1))
# LASSO-Regularisierung:
plot_glmnet(x = model_lasso, label = TRUE, xvar = "lambda")
title(main = "LASSO", line = 3)
```

```{r}
ind = which(coef_lasso!=0)
ind
```

```{r}
model = lm(lukashenko_share ~ number_of_voters_who_took_part_in_voting_at_the_place_of_residence  + Dmitriev + Lukashenko + Tikhanovskaya +number_of_votes_againts_all_candidates + latitude + longitude, data = data)

summary(model)

```

